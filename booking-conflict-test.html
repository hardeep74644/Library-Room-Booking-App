<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Conflict Test</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container">
        <h1>üß™ Booking Conflict Testing Tool</h1>
        <div class="card">
            <h2>Time Overlap Detection Test</h2>
            <p>This tool helps test the time overlap detection logic to ensure no double bookings occur.</p>

            <div class="form-group">
                <label>Requested Time Slot:</label>
                <input type="time" id="req-start" value="10:00"> to
                <input type="time" id="req-end" value="11:00">
            </div>

            <div class="form-group">
                <label>Existing Booking Time Slot:</label>
                <input type="time" id="existing-start" value="10:30"> to
                <input type="time" id="existing-end" value="11:30">
            </div>

            <button onclick="testOverlap()" class="btn-primary">Test Overlap</button>
            <button onclick="runAllTests()" class="btn-secondary">Run All Test Cases</button>

            <div id="result"
                style="margin-top: 20px; padding: 15px; border-radius: 5px; font-family: monospace; min-height: 50px; background: #f8f9fa;">
            </div>
        </div>

        <div class="card">
            <h2>Booking Conflict Scenarios</h2>
            <div id="scenarios">
                <button onclick="loadScenario('exact')" class="btn-secondary">Exact Same Time</button>
                <button onclick="loadScenario('partial-start')" class="btn-secondary">Partial Overlap (Start)</button>
                <button onclick="loadScenario('partial-end')" class="btn-secondary">Partial Overlap (End)</button>
                <button onclick="loadScenario('inside')" class="btn-secondary">Inside Existing</button>
                <button onclick="loadScenario('outside')" class="btn-secondary">Completely Outside</button>
                <button onclick="loadScenario('back-to-back')" class="btn-secondary">Back-to-back</button>
            </div>
        </div>
    </div>

    <script>
        // Overlap detection function (same as in student dashboard)
        function timesOverlap(start1, end1, start2, end2) {
            const overlap = (start1 < end2 && end1 > start2);
            console.log(`‚è∞ Time overlap check: (${start1}-${end1}) vs (${start2}-${end2}) = ${overlap}`);
            return overlap;
        }

        function testOverlap() {
            const reqStart = document.getElementById('req-start').value;
            const reqEnd = document.getElementById('req-end').value;
            const existingStart = document.getElementById('existing-start').value;
            const existingEnd = document.getElementById('existing-end').value;

            const result = timesOverlap(reqStart, reqEnd, existingStart, existingEnd);
            const resultDiv = document.getElementById('result');

            resultDiv.innerHTML = `
                <h4>Overlap Test Result:</h4>
                <p><strong>Requested:</strong> ${reqStart} - ${reqEnd}</p>
                <p><strong>Existing:</strong> ${existingStart} - ${existingEnd}</p>
                <p><strong>Overlap Detected:</strong> <span style="color: ${result ? '#dc3545' : '#28a745'}; font-weight: bold;">${result ? 'YES (CONFLICT!)' : 'NO (ALLOWED)'}</span></p>
                <p><em>${result ? 'This booking should be rejected due to time conflict.' : 'This booking should be allowed - no time conflict.'}</em></p>
            `;
        }

        function runAllTests() {
            const tests = [
                { name: 'Exact same time', req: ['10:00', '11:00'], existing: ['10:00', '11:00'], expected: true },
                { name: 'Partial overlap - start', req: ['09:30', '10:30'], existing: ['10:00', '11:00'], expected: true },
                { name: 'Partial overlap - end', req: ['10:30', '11:30'], existing: ['10:00', '11:00'], expected: true },
                { name: 'Completely inside', req: ['10:15', '10:45'], existing: ['10:00', '11:00'], expected: true },
                { name: 'Completely outside', req: ['11:00', '12:00'], existing: ['10:00', '11:00'], expected: false },
                { name: 'Back to back - no overlap', req: ['11:00', '12:00'], existing: ['10:00', '11:00'], expected: false },
                { name: 'Before - no overlap', req: ['09:00', '10:00'], existing: ['10:00', '11:00'], expected: false }
            ];

            let resultHTML = '<h4>All Test Results:</h4>';
            tests.forEach(test => {
                const result = timesOverlap(test.req[0], test.req[1], test.existing[0], test.existing[1]);
                const status = result === test.expected ? '‚úÖ' : '‚ùå';
                const color = result === test.expected ? '#28a745' : '#dc3545';
                resultHTML += `<p><span style="color: ${color}">${status} ${test.name}:</span> ${result} (expected: ${test.expected})</p>`;
            });

            document.getElementById('result').innerHTML = resultHTML;
        }

        function loadScenario(type) {
            const scenarios = {
                'exact': { req: ['10:00', '11:00'], existing: ['10:00', '11:00'] },
                'partial-start': { req: ['09:30', '10:30'], existing: ['10:00', '11:00'] },
                'partial-end': { req: ['10:30', '11:30'], existing: ['10:00', '11:00'] },
                'inside': { req: ['10:15', '10:45'], existing: ['10:00', '11:00'] },
                'outside': { req: ['11:30', '12:30'], existing: ['10:00', '11:00'] },
                'back-to-back': { req: ['11:00', '12:00'], existing: ['10:00', '11:00'] }
            };

            const scenario = scenarios[type];
            document.getElementById('req-start').value = scenario.req[0];
            document.getElementById('req-end').value = scenario.req[1];
            document.getElementById('existing-start').value = scenario.existing[0];
            document.getElementById('existing-end').value = scenario.existing[1];

            testOverlap();
        }

        // Run initial test
        document.addEventListener('DOMContentLoaded', () => {
            loadScenario('partial-start');
        });
    </script>

    <style>
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 0 5px;
        }

        #scenarios {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        #scenarios button {
            flex: 1;
            min-width: 150px;
        }
    </style>
</body>

</html>